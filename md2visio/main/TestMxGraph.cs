using md2visio.mxgraph;

namespace md2visio.main
{
    public class TestMxGraph
    {
        public static void Test()
        {
            string xml = @"<mxGraphModel><root><mxCell id=""2"" value=""开始访问网站"" style=""ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;"" vertex=""1"" parent=""1""><mxGeometry x=""300"" y=""40"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""3"" value=""浏览首页内容"" style=""rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;"" vertex=""1"" parent=""1""><mxGeometry x=""300"" y=""140"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""4"" value=""寻找需要的信息"" style=""rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;"" vertex=""1"" parent=""1""><mxGeometry x=""300"" y=""240"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""5"" value=""是否找到需要的内容？"" style=""rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;"" vertex=""1"" parent=""1""><mxGeometry x=""280"" y=""340"" width=""160"" height=""80"" as=""geometry""/></mxCell><mxCell id=""6"" value=""继续浏览其他页面"" style=""rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;"" vertex=""1"" parent=""1""><mxGeometry x=""100"" y=""460"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""7"" value=""执行目标行动"" style=""rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;"" vertex=""1"" parent=""1""><mxGeometry x=""300"" y=""460"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""8"" value=""离开网站"" style=""ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;"" vertex=""1"" parent=""1""><mxGeometry x=""500"" y=""460"" width=""120"" height=""60"" as=""geometry""/></mxCell><mxCell id=""9"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""2"" target=""3""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""10"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""3"" target=""4""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""11"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""4"" target=""5""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""12"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=0;exitY=0.5;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""5"" target=""6""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""13"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""5"" target=""7""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""14"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=1;exitY=0.5;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""6"" target=""8""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""15"" style=""edgeStyle=orthogonalEdgeStyle;endArrow=classic;exitX=1;exitY=0.5;entryX=0.5;entryY=0;"" edge=""1"" parent=""1"" source=""7"" target=""8""><mxGeometry relative=""1"" as=""geometry""/></mxCell><mxCell id=""16"" value=""否"" style=""text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;"" vertex=""1"" parent=""1""><mxGeometry x=""220"" y=""370"" width=""30"" height=""20"" as=""geometry""/></mxCell><mxCell id=""17"" value=""是"" style=""text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;"" vertex=""1"" parent=""1""><mxGeometry x=""340"" y=""430"" width=""30"" height=""20"" as=""geometry""/></mxCell></root></mxGraphModel>";

            var converter = new MxGraphConverter();
            converter.ConvertToVisio(xml, @"d:\temp\test.vsdx");
        }
    }
}